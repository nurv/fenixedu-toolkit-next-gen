{"version":3,"sources":["../../../src/js/toolkit/utils.js"],"names":[],"mappings":"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","file":"utils.js","sourcesContent":["import { currentLocale } from \"toolkit/locales\";\n\nexport function uniqueArray(arr){\n   var u = {}, a = [];\n   for(var i = 0, l = arr.length; i < l; ++i){\n      if(u.hasOwnProperty(arr[i])) {\n         continue;\n      }\n      a.push(arr[i]);\n      u[arr[i]] = 1;\n   }\n   return a;\n};\n\nexport function updateAttrs(input, widgetInput, allowedAttrs){\n    input = $(input);\n\n    var cache = widgetInput.data(\"attrCache\");\n\n    if (cache){\n        // If the attribute was removed after attaching to dom;\n        for (var i = 0; i < cache.length; i++) {\n            var attr = cache[i];\n            if (hasAttr(input, attr)){\n                widgetInput.removeAttr(attr);\n            } \n        };\n    }\n\n    cache = [];\n\n    $.each(input[0].attributes, function(i, attrib){\n        if (!(allowedAttrs.indexOf(attrib.name) < 0)){\n            widgetInput.attr(attrib.name,attrib.value);\n            cache.push(attrib.name);\n        }\n    });\n\n    widgetInput.data(\"attrCache\", cache)        \n};\n\nexport function hasAttr(obj,attr){\n    var val = $(obj).attr(attr);\n    return (typeof val !== typeof undefined && val !== false);\n};\n\nexport function replaceRequired(input){\n    input = $(input);\n\n    if (hasAttr(input,'required')) {\n        input.removeAttr(\"required\");\n        input.attr(\"bennu-required\",\"required\");\n    }\n}\n\nexport function gensym() {\n    var text = \"\";\n    var possible = \"abcdefghijklmnopqrstuvwxyz0123456789\";\n\n    for (var i = 0; i < 5; i++) {\n        text += possible.charAt(Math.floor(Math.random() * possible.length));\n    }\n\n    return text;\n}\n\nexport function closest(el, selector) {\n    var matchesFn;\n\n    // find vendor prefix\n    ['matches','webkitMatchesSelector','mozMatchesSelector','msMatchesSelector','oMatchesSelector'].some(function(fn) {\n        if (typeof document.body[fn] == 'function') {\n            matchesFn = fn;\n            return true;\n        }\n        return false;\n    })\n\n    // traverse parents\n    while (el!==null) {\n        parent = el.parentElement;\n        if (parent!==null && parent[matchesFn](selector)) {\n            return parent;\n        }\n        el = parent;\n    }\n\n    return null;\n}\n\nexport function insertAfter(newNode, referenceNode) {\n    referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\n}\n\nexport function cloneObject(obj) {\n  if (obj === null || typeof(obj) !== 'object' || 'isActiveClone' in obj)\n    return obj;\n\n  if (obj instanceof Date)\n    var temp = new obj.constructor(); //or new Date(obj);\n  else\n    var temp = obj.constructor();\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      obj['isActiveClone'] = null;\n      temp[key] = clone(obj[key]);\n      delete obj['isActiveClone'];\n    }\n  }\n\n  return temp;\n}\n\nexport class LocalizedString{\n  constructor(){\n    switch(arguments.length){\n      case 0:\n        this.data = {};\n        break;\n      case 1:\n        this.data = arguments[0];\n        break;\n      case 2:\n        this.data = {}\n        this.data[arguments[0]] = arguments[1];\n    }\n  }\n  \n  get(){\n      var locale;\n      var exactMatch = (arguments.length === 3) ? arguments[2] : false;\n      if(arguments.length === 0){\n        locale = currentLocale;\n      }else{\n        locale = arguments[0];\n      }\n\n      if (locale && typeof locale !== \"string\"){\n          var tag = locale.tag;\n      }else if(!locale){\n          var tag = Bennu.locale.tag;\n      }else{\n          var tag = locale\n      }\n\n      if (tag in input) {\n          return input[tag];\n      }\n\n      tag = tag.split('-')[0];\n      \n      if (tag in input) {\n          return input[tag];\n      }\n      \n      for (var lang in input) {\n          if (lang.indexOf(tag) === 0) {\n              return input[lang];\n          }\n      }\n      \n      return exactMatch ? null : input[Object.keys(input)[0]];\n  }\n\n  set(){\n    if(arguments.length === 1){\n      this.data[currentLocale] = arguments[0];\n    }else{\n      return this.data[arguments[1]] = arguments[0];\n    }\n  }\n\n  json(){\n    return this.data;\n  }\n\n  getLocales(){\n    var res = []\n    for(var k in this.data){\n      res.push(k);\n    }\n    return res;\n  }\n\n  toString(){\n    return JSON.stringify(this.data);\n  }\n}\n\n\n\n "]}